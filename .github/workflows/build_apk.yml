name: ğŸ“± Build Android APK

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: â¬‡ï¸ 1. æ‹‰å–ä»£ç 
        uses: actions/checkout@v4       # å‡çº§ä¸º v4

      - name: ğŸŸ¢ 2. è®¾ç½® Node.js ç¯å¢ƒ
        uses: actions/setup-node@v4     # å‡çº§ä¸º v4
        with:
          node-version: '18'

      - name: â˜• 3. è®¾ç½® Java ç¯å¢ƒ (JDK 17)
        uses: actions/setup-java@v4     # å‡çº§ä¸º v4
        with:
          distribution: 'temurin'
          java-version: '17'

      - name: ğŸ“¦ 4. å®‰è£…ä¾èµ–
        run: npm install

      - name: ğŸ”§ 5. åˆå§‹åŒ–å®‰å“ç¯å¢ƒ
        run: |
          npx cap add android
          npx cap sync android

      - name: ğŸ”¨ 6. æ‰“åŒ… APK
        working-directory: ./android
        run: ./gradlew assembleDebug

      - name: ğŸ“¤ 7. ä¸Šä¼  APK åˆ° GitHub
        uses: actions/upload-artifact@v4  # å…³é”®ä¿®å¤ï¼šå‡çº§ä¸º v4
        with:
          name: Jwc-Knowledge-App
          path: android/app/build/outputs/apk/debug/app-debug.apk
