<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jwc çŸ¥è¯†åº“</title>
    <style>
        /* ... (ä¿ç•™ä¹‹å‰çš„æ ·å¼) ... */
        body { font-family: -apple-system, sans-serif; background: #f5f5f5; margin: 0; }
        header { background: #007bff; color: white; padding: 15px; text-align: center; position: sticky; top: 0; z-index: 100; display: flex; justify-content: space-between; align-items: center;}
        .status-badge { font-size: 12px; padding: 2px 8px; border-radius: 10px; background: rgba(255,255,255,0.2); }
        .node { background: white; border-bottom: 1px solid #eee; }
        .node-title { padding: 15px; display: flex; align-items: center; cursor: pointer; }
        .icon { margin-right: 10px; }
        .text { flex: 1; color: #333; text-decoration: none;}
        .children { display: none; padding-left: 20px; background: #fafafa; }
        .children.show { display: block; }
        a { text-decoration: none; color: inherit; display: flex; width: 100%; align-items: center;}
    </style>
</head>
<body>

<header>
    <span>ğŸ“š çŸ¥è¯†åº“</span>
    <span id="status" class="status-badge">æ£€æµ‹ä¸­...</span>
</header>
<div id="app"></div>

<script src="data.js"></script>

<script>
    // === é…ç½®åŒºåŸŸ ===
    // âš ï¸é‡è¦ï¼šæŠŠä¸‹é¢çš„åœ°å€æ¢æˆä½  Gitee ä»“åº“ data.js çš„ Raw åœ°å€
    // æ ¼å¼é€šå¸¸æ˜¯: https://gitee.com/ç”¨æˆ·å/ä»“åº“å/raw/master/Documents/data.js
    // === é…ç½®åŒºåŸŸ (å·²é’ˆå¯¹ä½ çš„ä»“åº“ä¼˜åŒ–) ===
    // ä»“åº“åœ°å€: https://gitee.com/jystarx/aigent
    
    // 1. data.js çš„åŸå§‹æ•°æ®åœ°å€ (æ³¨æ„ï¼šå‡è®¾ä½ çš„ä¸»åˆ†æ”¯å« master)
    const GITEE_DATA_URL = 'https://gitee.com/jystarx/aigent/raw/master/Documents/data.js';
    
    // 2. PDF æ–‡ä»¶çš„æ ¹ç›®å½•åœ°å€
    const GITEE_PDF_ROOT = 'https://gitee.com/jystarx/aigent/raw/master/Documents/';

    const app = document.getElementById('app');
    const statusLabel = document.getElementById('status');
    let useOnline = false;

    // æ¸²æŸ“å‡½æ•°
    function renderTree(nodes, container, isRoot = false) {
        if(isRoot) container.innerHTML = ''; // æ¸…ç©ºæ—§å†…å®¹
        
        nodes.forEach(node => {
            const nodeDiv = document.createElement('div');
            nodeDiv.className = 'node';

            if (node.pdf) {
                // === å…³é”®ç‚¹ï¼šåŠ¨æ€å†³å®š PDF è·¯å¾„ ===
                // å¦‚æœæ˜¯åœ¨çº¿æ¨¡å¼ï¼Œæ‹¼è£… Gitee åœ°å€ï¼›å¦‚æœæ˜¯ç¦»çº¿ï¼Œç”¨ç›¸å¯¹åœ°å€
                let pdfPath = node.pdf;
                if (useOnline) {
                    // node.pdf åŸå§‹å€¼ç±»ä¼¼ "docs_pdf/folder/file.pdf"
                    // æˆ‘ä»¬ç›´æ¥æ‹¼æ¥åˆ° Gitee æ ¹è·¯å¾„åé¢
                    pdfPath = GITEE_PDF_ROOT + node.pdf;
                }
                
                nodeDiv.innerHTML = `
                    <div class="node-title">
                        <a href="${pdfPath}">
                            <span class="icon">ğŸ“„</span>
                            <span class="text">${node.title}</span>
                        </a>
                    </div>
                `;
            } else {
                // æ–‡ä»¶å¤¹é€»è¾‘ (ä¿æŒä¸å˜)
                const titleDiv = document.createElement('div');
                titleDiv.className = 'node-title';
                titleDiv.innerHTML = `<span class="icon">ğŸ“‚</span><span class="text">${node.title}</span>`;
                const childrenContainer = document.createElement('div');
                childrenContainer.className = 'children';
                
                titleDiv.onclick = () => {
                    childrenContainer.classList.toggle('show');
                };
                
                nodeDiv.appendChild(titleDiv);
                nodeDiv.appendChild(childrenContainer);
                if (node.children) renderTree(node.children, childrenContainer);
            }
            container.appendChild(nodeDiv);
        });
    }

    // åˆå§‹åŒ–æ£€æŸ¥
    async function init() {
        try {
            // 1. å…ˆåŠ è½½æœ¬åœ°æ•°æ®å…œåº•
            if (typeof LOCAL_DATA !== 'undefined') {
                renderTree(LOCAL_DATA.tree, app, true);
                statusLabel.innerText = "ç¦»çº¿æ¨¡å¼ (v" + LOCAL_DATA.version + ")";
            }

            // 2. å°è¯•è¯·æ±‚äº‘ç«¯æ•°æ®
            console.log("æ­£åœ¨æ£€æŸ¥æ›´æ–°...");
            const response = await fetch(GITEE_DATA_URL);
            if (!response.ok) throw new Error("ç½‘ç»œä¸å¯è¾¾");

            // è§£æäº‘ç«¯ JS (å› ä¸ºå®ƒæ˜¯ä¸€ä¸ª js æ–‡ä»¶ä¸æ˜¯ jsonï¼Œæˆ‘ä»¬éœ€è¦æå–å¯¹è±¡)
            const scriptText = await response.text();
            // è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ hackï¼Œé€šè¿‡æ‰§è¡Œå­—ç¬¦ä¸²é‡Œçš„ JSON éƒ¨åˆ†æ¥è·å–å¯¹è±¡
            // å‡è®¾æ–‡ä»¶å†…å®¹æ˜¯: const LOCAL_DATA = { ... };
            const jsonStr = scriptText.substring(scriptText.indexOf('{'), scriptText.lastIndexOf('}') + 1);
            const remoteData = JSON.parse(jsonStr);

            // 3. ç‰ˆæœ¬å¯¹æ¯”
            const localVer = (typeof LOCAL_DATA !== 'undefined') ? Number(LOCAL_DATA.version) : 0;
            const remoteVer = Number(remoteData.version);

            if (remoteVer > localVer) {
                console.log("å‘ç°æ–°ç‰ˆæœ¬ï¼Œåˆ‡æ¢åˆ°åœ¨çº¿æ¨¡å¼");
                useOnline = true;
                statusLabel.innerText = "ğŸŸ¢ åœ¨çº¿ (v" + remoteVer + ")";
                statusLabel.style.background = "#28a745";
                // ä½¿ç”¨äº‘ç«¯æ•°æ®é‡æ–°æ¸²æŸ“
                renderTree(remoteData.tree, app, true);
            } else {
                console.log("æœ¬åœ°å·²æ˜¯æœ€æ–°");
                statusLabel.innerText = "âšª ç¦»çº¿ (æœ€æ–°)";
            }

        } catch (e) {
            console.log("æ— æ³•è¿æ¥äº‘ç«¯ï¼Œä¿æŒç¦»çº¿æ¨¡å¼", e);
            statusLabel.innerText = "ğŸ“´ ç¦»çº¿æ¨¡å¼";
        }
    }

    init();
</script>
</body>
</html>