<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Jwc çŸ¥è¯†åº“ (è¯Šæ–­æ¨¡å¼)</title>
    
    <style>
        body { font-family: sans-serif; margin: 0; padding: 0; background: #f0f0f0; }
        .header { background: #007bff; color: white; padding: 15px; font-weight: bold; }
        
        /* ğŸ”´ å±å¹•ä¸Šçš„é»‘åº•çº¢å­—è°ƒè¯•æ¡† */
        #debug-console {
            background: #000; color: #0f0; font-family: monospace;
            padding: 15px; margin: 10px; border-radius: 5px;
            min-height: 200px; white-space: pre-wrap; word-break: break-all;
            font-size: 13px; border: 2px solid red; overflow: auto;
        }
        .node { background: white; border-bottom: 1px solid #ddd; padding: 15px; }
    </style>

    <script>
        window.onerror = function(msg, source, lineno, colno, error) {
            const box = document.getElementById('debug-console');
            if(box) {
                box.innerHTML += `\nâŒ [JSé”™è¯¯] ${msg}\n   è¡Œå·: ${lineno}`;
                box.style.color = '#ff4444'; // å˜çº¢
            }
            return false;
        };
        
        function log(msg) {
            const box = document.getElementById('debug-console');
            if(box) box.innerHTML += `\n> ${msg}`;
        }
    </script>

    <script src="lib/pdfjs/pdf.min.js"></script>
    <script src="data.js"></script>

</head>
<body>

    <div class="header">ğŸ› ï¸ å¯åŠ¨è¯Šæ–­...</div>
    
    <div id="debug-console">ç­‰å¾…è„šæœ¬è¿è¡Œ...</div>
    
    <div id="file-list"></div>

<script>
    const consoleBox = document.getElementById('debug-console');

    // === è‡ªæ£€æµç¨‹ ===
    try {
        log("æ­¥éª¤ 1: æ£€æŸ¥ PDF åº“...");
        if (typeof pdfjsLib === 'undefined') {
            throw new Error("pdfjsLib æœªå®šä¹‰ï¼\nåŸå› : lib/pdfjs/pdf.min.js æ–‡ä»¶æŸåæˆ–ä¸¢å¤±ã€‚");
        }
        log("âœ… PDF åº“æ­£å¸¸ã€‚");

        // é…ç½® worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'lib/pdfjs/pdf.worker.min.js';

        log("æ­¥éª¤ 2: æ£€æŸ¥æ•°æ®...");
        if (typeof LOCAL_DATA === 'undefined') {
            log("âš ï¸ LOCAL_DATA æœªå®šä¹‰ã€‚");
            log("è¿™æ„å‘³ç€ data.js æ–‡ä»¶å¯èƒ½ä¸ºç©ºæˆ–ä¸å­˜åœ¨ã€‚");
        } else {
            log(`âœ… æ•°æ®åŠ è½½æˆåŠŸ! ç‰ˆæœ¬: ${LOCAL_DATA.version}`);
            log(`åŒ…å«èŠ‚ç‚¹æ•°: ${LOCAL_DATA.tree.length}`);
            renderTree(LOCAL_DATA.tree, document.getElementById('file-list'));
        }

    } catch (e) {
        log(`âŒ è‡´å‘½é”™è¯¯: ${e.message}`);
    }

    // === ç®€å•æ¸²æŸ“ ===
    function renderTree(nodes, container) {
        let html = '';
        nodes.forEach(node => {
            const icon = node.children ? 'ğŸ“‚' : 'ğŸ“„';
            html += `<div class="node">${icon} ${node.title}</div>`;
        });
        container.innerHTML = html;
        log("âœ… åˆ—è¡¨æ¸²æŸ“å®Œæˆ");
    }
</script>

</body>
</html>